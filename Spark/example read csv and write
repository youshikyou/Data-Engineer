# Import the data to a DataFrame
departures_df = spark.read.csv(path="2015-departures.csv.gz", header=True)

# Remove any duration of 0
departures_df = departures_df.filter(departures_df[3]>0)

# Add an ID column
departures_df = departures_df.withColumn('id', F.monotonically_increasing_id())

# Write the file out to JSON format
departures_df.write.json("output.json", mode='overwrite')
